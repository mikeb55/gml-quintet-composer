<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Quintet Composer v9.5 - Harmonic Architecture</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            border-radius: 20px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
            overflow: hidden;
        }
        
        .header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 30px;
            text-align: center;
        }
        
        .header h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
        }
        
        .header p {
            font-size: 1.2em;
            opacity: 0.9;
        }
        
        .main-content {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 30px;
            padding: 30px;
        }
        
        .section {
            background: #f8f9fa;
            border-radius: 10px;
            padding: 20px;
        }
        
        .section h2 {
            color: #667eea;
            margin-bottom: 20px;
            padding-bottom: 10px;
            border-bottom: 2px solid #667eea;
        }
        
        .control-group {
            margin-bottom: 20px;
        }
        
        .control-group label {
            display: block;
            margin-bottom: 5px;
            color: #333;
            font-weight: 600;
        }
        
        .control-group input,
        .control-group select,
        .control-group textarea {
            width: 100%;
            padding: 10px;
            border: 2px solid #e0e0e0;
            border-radius: 5px;
            font-size: 14px;
            transition: border-color 0.3s;
        }
        
        .control-group input:focus,
        .control-group select:focus {
            outline: none;
            border-color: #667eea;
        }
        
        .btn {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            padding: 12px 30px;
            border-radius: 5px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: transform 0.3s, box-shadow 0.3s;
            margin-right: 10px;
            margin-bottom: 10px;
        }
        
        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 20px rgba(102, 126, 234, 0.4);
        }
        
        .btn-secondary {
            background: #6c757d;
        }
        
        .btn-success {
            background: #28a745;
        }
        
        .progress-bar {
            width: 100%;
            height: 30px;
            background: #e0e0e0;
            border-radius: 15px;
            overflow: hidden;
            margin-top: 20px;
        }
        
        .progress-fill {
            height: 100%;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            width: 0%;
            transition: width 0.5s;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: 600;
        }
        
        .status-message {
            padding: 15px;
            border-radius: 5px;
            margin-top: 20px;
            display: none;
        }
        
        .status-success {
            background: #d4edda;
            color: #155724;
            border: 1px solid #c3e6cb;
        }
        
        .status-error {
            background: #f8d7da;
            color: #721c24;
            border: 1px solid #f5c6cb;
        }
        
        .status-info {
            background: #d1ecf1;
            color: #0c5460;
            border: 1px solid #bee5eb;
        }
        
        .instrument-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 10px;
            margin-top: 10px;
        }
        
        .instrument-card {
            background: white;
            padding: 15px;
            border-radius: 5px;
            text-align: center;
            border: 2px solid #e0e0e0;
            cursor: pointer;
            transition: all 0.3s;
        }
        
        .instrument-card.active {
            border-color: #667eea;
            background: #f0f4ff;
        }
        
        .instrument-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }
        
        .full-width {
            grid-column: span 2;
        }
        
        .preview-area {
            background: white;
            padding: 20px;
            border-radius: 10px;
            min-height: 200px;
            border: 2px dashed #e0e0e0;
        }
        
        .chord-display {
            font-size: 24px;
            font-weight: bold;
            color: #764ba2;
            text-align: center;
            padding: 20px;
            background: #f0f4ff;
            border-radius: 10px;
            margin-top: 10px;
        }
        
        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.05); }
            100% { transform: scale(1); }
        }
        
        .generating {
            animation: pulse 1s infinite;
        }
        
        .tabs {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
        }
        
        .tab {
            padding: 10px 20px;
            background: #e0e0e0;
            border-radius: 5px 5px 0 0;
            cursor: pointer;
            transition: all 0.3s;
        }
        
        .tab.active {
            background: white;
            color: #667eea;
            font-weight: 600;
        }
        
        .tab-content {
            display: none;
        }
        
        .tab-content.active {
            display: block;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>ðŸŽ¼ Quintet Composer v9.5</h1>
            <p>"Harmonic Architecture" - Advanced Polyrhythmic Composition System</p>
        </div>
        
        <div class="main-content">
            <!-- Left Panel - Input Controls -->
            <div class="section">
                <h2>Composition Settings</h2>
                
                <div class="tabs">
                    <div class="tab active" onclick="switchTab('basic')">Basic</div>
                    <div class="tab" onclick="switchTab('advanced')">Advanced</div>
                    <div class="tab" onclick="switchTab('midi')">MIDI Import</div>
                </div>
                
                <div id="basic-tab" class="tab-content active">
                    <div class="control-group">
                        <label>Composition Title</label>
                        <input type="text" id="title" value="Quintet in C Major">
                    </div>
                    
                    <div class="control-group">
                        <label>Tempo (BPM)</label>
                        <input type="range" id="tempo" min="60" max="200" value="120">
                        <span id="tempo-display">120 BPM</span>
                    </div>
                    
                    <div class="control-group">
                        <label>Key Signature</label>
                        <select id="key">
                            <option value="C">C Major</option>
                            <option value="G">G Major</option>
                            <option value="D">D Major</option>
                            <option value="A">A Major</option>
                            <option value="F">F Major</option>
                            <option value="Bb">Bb Major</option>
                            <option value="Am">A Minor</option>
                            <option value="Em">E Minor</option>
                        </select>
                    </div>
                    
                    <div class="control-group">
                        <label>Composer Style</label>
                        <select id="style">
                            <option value="classical">Classical (Mozart)</option>
                            <option value="baroque">Baroque (Bach)</option>
                            <option value="romantic">Romantic (Brahms)</option>
                            <option value="modern">Modern (Polyrhythmic)</option>
                        </select>
                    </div>
                </div>
                
                <div id="advanced-tab" class="tab-content">
                    <div class="control-group">
                        <label>Time Signature</label>
                        <select id="timesig">
                            <option value="4/4">4/4</option>
                            <option value="3/4">3/4</option>
                            <option value="6/8">6/8</option>
                            <option value="5/4">5/4</option>
                            <option value="7/8">7/8</option>
                        </select>
                    </div>
                    
                    <div class="control-group">
                        <label>Structure Template</label>
                        <select id="structure">
                            <option value="standard">Intro-Verse-Chorus-Bridge-Outro</option>
                            <option value="sonata">Sonata Form</option>
                            <option value="rondo">Rondo (ABACABA)</option>
                            <option value="theme">Theme & Variations</option>
                        </select>
                    </div>
                    
                    <div class="control-group">
                        <label>Harmonic Complexity</label>
                        <input type="range" id="complexity" min="1" max="10" value="5">
                        <span id="complexity-display">5</span>
                    </div>
                    
                    <div class="control-group">
                        <label>Polyrhythmic Density</label>
                        <input type="range" id="polyrhythm" min="0" max="10" value="3">
                        <span id="polyrhythm-display">3</span>
                    </div>
                </div>
                
                <div id="midi-tab" class="tab-content">
                    <div class="control-group">
                        <label>Import MIDI Theme</label>
                        <input type="file" id="midi-file" accept=".mid,.midi">
                    </div>
                    
                    <div class="control-group">
                        <label>Theme Treatment</label>
                        <select id="theme-treatment">
                            <option value="exact">Exact Transcription</option>
                            <option value="variation">Create Variations</option>
                            <option value="fugue">Fugal Treatment</option>
                            <option value="development">Motivic Development</option>
                        </select>
                    </div>
                    
                    <div class="preview-area">
                        <p id="midi-preview">No MIDI file loaded</p>
                    </div>
                </div>
                
                <button class="btn" onclick="generateComposition()">
                    Generate Composition
                </button>
                <button class="btn btn-secondary" onclick="previewChords()">
                    Preview Chords
                </button>
                <button class="btn btn-success" id="download-btn" style="display:none" onclick="downloadXML()">
                    Download MusicXML
                </button>
            </div>
            
            <!-- Right Panel - Instruments and Output -->
            <div class="section">
                <h2>Ensemble Configuration</h2>
                
                <div class="instrument-grid">
                    <div class="instrument-card active" data-instrument="guitar">
                        ðŸŽ¸ Guitar
                    </div>
                    <div class="instrument-card active" data-instrument="violin1">
                        ðŸŽ» Violin I
                    </div>
                    <div class="instrument-card active" data-instrument="violin2">
                        ðŸŽ» Violin II
                    </div>
                    <div class="instrument-card active" data-instrument="viola">
                        ðŸŽ» Viola
                    </div>
                    <div class="instrument-card active" data-instrument="cello">
                        ðŸŽ» Cello
                    </div>
                </div>
                
                <div class="control-group" style="margin-top: 20px;">
                    <label>Current Chord Progression</label>
                    <div class="chord-display" id="chord-display">
                        C - Am - F - G
                    </div>
                </div>
                
                <div class="progress-bar">
                    <div class="progress-fill" id="progress">0%</div>
                </div>
                
                <div class="status-message" id="status"></div>
                
                <div class="control-group" style="margin-top: 20px;">
                    <label>Composition Log</label>
                    <textarea id="log" rows="8" readonly>Ready to compose...</textarea>
                </div>
            </div>
        </div>
        
        <!-- Full Width Section -->
        <div class="section full-width" style="margin: 0 30px 30px 30px;">
            <h2>Composition Preview</h2>
            <div class="preview-area">
                <div id="composition-preview">
                    <p>Click "Generate Composition" to create your quintet piece</p>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Quintet Composer v9.5 Core Engine
        class QuintetComposer {
            constructor() {
                this.divisions = 256;
                this.currentXML = null;
                this.activeInstruments = ['guitar', 'violin1', 'violin2', 'viola', 'cello'];
                
                this.sections = {
                    'intro': { measures: 4, theme: 'opening' },
                    'verse': { measures: 8, theme: 'main' },
                    'chorus': { measures: 8, theme: 'lift' },
                    'bridge': { measures: 8, theme: 'contrast' },
                    'outro': { measures: 4, theme: 'closing' }
                };
                
                this.chordProgressions = {
                    'opening': ['C', 'C', 'G', 'G'],
                    'main': ['C', 'Am', 'F', 'G', 'C', 'Am', 'F', 'G'],
                    'lift': ['F', 'G', 'C', 'Am', 'F', 'G', 'C', 'C'],
                    'contrast': ['Am', 'F', 'C', 'G', 'Am', 'F', 'G', 'G'],
                    'closing': ['C', 'F', 'G', 'C']
                };
                
                this.chordNotes = {
                    'C': { root: 'C', third: 'E', fifth: 'G' },
                    'Am': { root: 'A', third: 'C', fifth: 'E' },
                    'F': { root: 'F', third: 'A', fifth: 'C' },
                    'G': { root: 'G', third: 'B', fifth: 'D' }
                };
                
                this.melodicThemes = {
                    'opening': {
                        violin1: ['G4', 'G4', 'A4', 'G4', 'C5', 'B4', 'G4', 'G4'],
                        violin2: ['E4', 'E4', 'F4', 'E4', 'G4', 'G4', 'E4', 'E4']
                    },
                    'main': {
                        violin1: ['C5', 'B4', 'A4', 'G4', 'F4', 'E4', 'D4', 'C4'],
                        violin2: ['E4', 'G4', 'F4', 'E4', 'D4', 'C4', 'B3', 'C4']
                    },
                    'lift': {
                        violin1: ['F4', 'G4', 'A4', 'C5', 'C5', 'B4', 'A4', 'G4'],
                        violin2: ['A4', 'G4', 'F4', 'E4', 'E4', 'D4', 'C4', 'E4']
                    },
                    'contrast': {
                        violin1: ['A4', 'G4', 'F4', 'E4', 'D4', 'E4', 'F4', 'G4'],
                        violin2: ['C4', 'D4', 'E4', 'G4', 'F4', 'E4', 'D4', 'B3']
                    },
                    'closing': {
                        violin1: ['C5', 'G4', 'E4', 'C4', 'G4', 'E4', 'C4', 'C4'],
                        violin2: ['E4', 'C4', 'G3', 'E3', 'C4', 'G3', 'E3', 'E3']
                    }
                };
                
                this.guitarPatterns = {
                    'C': ['C3', 'E3', 'G3', 'C4', 'E4'],
                    'Am': ['A2', 'E3', 'A3', 'C4', 'E4'],
                    'F': ['F3', 'A3', 'C4', 'F4', 'A4'],
                    'G': ['G2', 'B2', 'D3', 'G3', 'B3']
                };
            }
            
            generateMusicXML(settings = {}) {
                const title = settings.title || 'Quintet Composition v9.5';
                const tempo = settings.tempo || 120;
                
                let xml = '<?xml version="1.0" encoding="UTF-8" standalone="no"?>\n';
                xml += '<!DOCTYPE score-partwise PUBLIC "-//Recordare//DTD MusicXML 3.0 Partwise//EN" "http://www.musicxml.org/dtds/partwise.dtd">\n';
                xml += '<score-partwise version="3.0">\n';
                
                xml += this.generateHeader(title);
                xml += this.generatePartList();
                
                if (this.activeInstruments.includes('guitar')) {
                    xml += this.generateGuitarPart();
                }
                if (this.activeInstruments.includes('violin1')) {
                    xml += this.generateViolinPart(1);
                }
                if (this.activeInstruments.includes('violin2')) {
                    xml += this.generateViolinPart(2);
                }
                if (this.activeInstruments.includes('viola')) {
                    xml += this.generateViolaPart();
                }
                if (this.activeInstruments.includes('cello')) {
                    xml += this.generateCelloPart();
                }
                
                xml += '</score-partwise>\n';
                this.currentXML = xml;
                return xml;
            }
            
            generateHeader(title) {
                return `  <work>
    <work-title>${title}</work-title>
  </work>
  <identification>
    <encoding>
      <software>Quintet Composer v9.5</software>
      <encoding-date>${new Date().toISOString().split('T')[0]}</encoding-date>
    </encoding>
  </identification>\n`;
            }
            
            generatePartList() {
                return `  <part-list>
    <score-part id="P1">
      <part-name>Guitar</part-name>
    </score-part>
    <score-part id="P2">
      <part-name>Violin I</part-name>
    </score-part>
    <score-part id="P3">
      <part-name>Violin II</part-name>
    </score-part>
    <score-part id="P4">
      <part-name>Viola</part-name>
    </score-part>
    <score-part id="P5">
      <part-name>Cello</part-name>
    </score-part>
  </part-list>\n`;
            }
            
            generateGuitarPart() {
                let xml = '  <part id="P1">\n';
                let measureNum = 1;
                
                for (const [sectionName, section] of Object.entries(this.sections)) {
                    const progression = this.chordProgressions[section.theme];
                    
                    for (let m = 0; m < section.measures; m++) {
                        const chord = progression[m % progression.length];
                        const pattern = this.guitarPatterns[chord];
                        
                        xml += `    <measure number="${measureNum}">\n`;
                        
                        if (measureNum === 1) {
                            xml += this.generateAttributes('G', 2, -1);
                        }
                        
                        const notes = [
                            pattern[0], pattern[1], pattern[2], pattern[1],
                            pattern[3], pattern[2], pattern[4], pattern[3]
                        ];
                        
                        for (const note of notes) {
                            xml += this.generateNote(note, 128, 'eighth');
                        }
                        
                        xml += '    </measure>\n';
                        measureNum++;
                    }
                }
                
                xml += '  </part>\n';
                return xml;
            }
            
            generateViolinPart(violinNumber) {
                let xml = `  <part id="P${violinNumber + 1}">\n`;
                let measureNum = 1;
                
                for (const [sectionName, section] of Object.entries(this.sections)) {
                    const theme = this.melodicThemes[section.theme];
                    const pattern = violinNumber === 1 ? theme.violin1 : theme.violin2;
                    
                    for (let m = 0; m < section.measures; m++) {
                        xml += `    <measure number="${measureNum}">\n`;
                        
                        if (measureNum === 1) {
                            xml += this.generateAttributes('G', 2);
                        }
                        
                        for (let n = 0; n < 8; n++) {
                            let note = pattern[n];
                            if (m % 4 === 3 && n % 2 === 0 && n < 7) {
                                xml += this.generateNote(note, 256, 'quarter');
                                n++;
                            } else {
                                xml += this.generateNote(note, 128, 'eighth');
                            }
                        }
                        
                        xml += '    </measure>\n';
                        measureNum++;
                    }
                }
                
                xml += '  </part>\n';
                return xml;
            }
            
            generateViolaPart() {
                let xml = '  <part id="P4">\n';
                let measureNum = 1;
                
                for (const [sectionName, section] of Object.entries(this.sections)) {
                    const progression = this.chordProgressions[section.theme];
                    
                    for (let m = 0; m < section.measures; m++) {
                        const chord = progression[m % progression.length];
                        const chordTones = this.chordNotes[chord];
                        
                        xml += `    <measure number="${measureNum}">\n`;
                        
                        if (measureNum === 1) {
                            xml += this.generateAttributes('C', 3);
                        }
                        
                        xml += this.generateNote(chordTones.root + '3', 512, 'half');
                        xml += this.generateNote(chordTones.fifth + '3', 512, 'half');
                        
                        xml += '    </measure>\n';
                        measureNum++;
                    }
                }
                
                xml += '  </part>\n';
                return xml;
            }
            
            generateCelloPart() {
                let xml = '  <part id="P5">\n';
                let measureNum = 1;
                
                for (const [sectionName, section] of Object.entries(this.sections)) {
                    const progression = this.chordProgressions[section.theme];
                    
                    for (let m = 0; m < section.measures; m++) {
                        const chord = progression[m % progression.length];
                        const rootNote = this.chordNotes[chord].root;
                        
                        xml += `    <measure number="${measureNum}">\n`;
                        
                        if (measureNum === 1) {
                            xml += this.generateAttributes('F', 4);
                        }
                        
                        xml += this.generateNote(rootNote + '2', 1024, 'whole');
                        
                        xml += '    </measure>\n';
                        measureNum++;
                    }
                }
                
                xml += '  </part>\n';
                return xml;
            }
            
            generateAttributes(clefSign, clefLine, octaveChange = 0) {
                let xml = '      <attributes>\n';
                xml += `        <divisions>${this.divisions}</divisions>\n`;
                xml += '        <key>\n';
                xml += '          <fifths>0</fifths>\n';
                xml += '        </key>\n';
                xml += '        <time>\n';
                xml += '          <beats>4</beats>\n';
                xml += '          <beat-type>4</beat-type>\n';
                xml += '        </time>\n';
                xml += '        <clef>\n';
                xml += `          <sign>${clefSign}</sign>\n`;
                xml += `          <line>${clefLine}</line>\n`;
                xml += '        </clef>\n';
                
                if (octaveChange !== 0) {
                    xml += '        <transpose>\n';
                    xml += '          <diatonic>0</diatonic>\n';
                    xml += '          <chromatic>0</chromatic>\n';
                    xml += `          <octave-change>${octaveChange}</octave-change>\n`;
                    xml += '        </transpose>\n';
                }
                
                xml += '      </attributes>\n';
                return xml;
            }
            
            generateNote(pitchStr, duration, type) {
                const pitch = pitchStr.substring(0, pitchStr.length - 1);
                const octave = pitchStr.substring(pitchStr.length - 1);
                
                let xml = '      <note>\n';
                xml += '        <pitch>\n';
                xml += `          <step>${pitch}</step>\n`;
                xml += `          <octave>${octave}</octave>\n`;
                xml += '        </pitch>\n';
                xml += `        <duration>${duration}</duration>\n`;
                xml += `        <type>${type}</type>\n`;
                xml += '      </note>\n';
                return xml;
            }
        }
        
        // Global composer instance
        const composer = new QuintetComposer();
        
        // UI Functions
        function switchTab(tabName) {
            document.querySelectorAll('.tab').forEach(tab => {
                tab.classList.remove('active');
            });
            document.querySelectorAll('.tab-content').forEach(content => {
                content.classList.remove('active');
            });
            
            event.target.classList.add('active');
            document.getElementById(tabName + '-tab').classList.add('active');
        }
        
        function updateProgress(percent, message) {
            const progressBar = document.getElementById('progress');
            progressBar.style.width = percent + '%';
            progressBar.textContent = percent + '%';
            
            const log = document.getElementById('log');
            log.value += '\n' + message;
            log.scrollTop = log.scrollHeight;
        }
        
        function showStatus(message, type = 'info') {
            const status = document.getElementById('status');
            status.className = 'status-message status-' + type;
            status.textContent = message;
            status.style.display = 'block';
            
            setTimeout(() => {
                status.style.display = 'none';
            }, 5000);
        }
        
        function generateComposition() {
            const button = event.target;
            button.classList.add('generating');
            
            updateProgress(0, 'Starting composition generation...');
            
            setTimeout(() => {
                updateProgress(20, 'Analyzing harmonic structure...');
                
                setTimeout(() => {
                    updateProgress(40, 'Generating melodic themes...');
                    
                    setTimeout(() => {
                        updateProgress(60, 'Creating polyrhythmic patterns...');
                        
                        setTimeout(() => {
                            updateProgress(80, 'Finalizing arrangement...');
                            
                            setTimeout(() => {
                                const settings = {
                                    title: document.getElementById('title').value,
                                    tempo: document.getElementById('tempo').value
                                };
                                
                                const xml = composer.generateMusicXML(settings);
                                
                                updateProgress(100, 'Composition complete!');
                                button.classList.remove('generating');
                                
                                showStatus('Composition generated successfully!', 'success');
                                document.getElementById('download-btn').style.display = 'inline-block';
                                
                                // Update preview
                                const preview = document.getElementById('composition-preview');
                                preview.innerHTML = `
                                    <h3>âœ… ${settings.title}</h3>
                                    <p><strong>Format:</strong> MusicXML 3.0</p>
                                    <p><strong>Measures:</strong> 32</p>
                                    <p><strong>Instruments:</strong> ${composer.activeInstruments.join(', ')}</p>
                                    <p><strong>Structure:</strong> Intro (4) â†’ Verse (8) â†’ Chorus (8) â†’ Bridge (8) â†’ Outro (4)</p>
                                    <p><strong>Size:</strong> ${(xml.length / 1024).toFixed(2)} KB</p>
                                `;
                            }, 500);
                        }, 500);
                    }, 500);
                }, 500);
            }, 500);
        }
        
        function previewChords() {
            const progressions = ['C - G - Am - F', 'F - G - C - Am', 'Am - F - C - G', 'C - F - G - C'];
            let index = 0;
            
            const display = document.getElementById('chord-display');
            
            const interval = setInterval(() => {
                display.textContent = progressions[index];
                index++;
                
                if (index >= progressions.length) {
                    clearInterval(interval);
                    showStatus('Chord preview complete', 'info');
                }
            }, 1000);
        }
        
        function downloadXML() {
            if (!composer.currentXML) {
                showStatus('Please generate a composition first', 'error');
                return;
            }
            
            const blob = new Blob([composer.currentXML], { type: 'text/xml' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = 'quintet_v9.5_harmonic_architecture.musicxml';
            a.click();
            URL.revokeObjectURL(url);
            
            showStatus('MusicXML file downloaded!', 'success');
        }
        
        // Event listeners
        document.getElementById('tempo').addEventListener('input', function() {
            document.getElementById('tempo-display').textContent = this.value + ' BPM';
        });
        
        document.getElementById('complexity').addEventListener('input', function() {
            document.getElementById('complexity-display').textContent = this.value;
        });
        
        document.getElementById('polyrhythm').addEventListener('input', function() {
            document.getElementById('polyrhythm-display').textContent = this.value;
        });
        
        // Instrument selection
        document.querySelectorAll('.instrument-card').forEach(card => {
            card.addEventListener('click', function() {
                this.classList.toggle('active');
                const instrument = this.dataset.instrument;
                const index = composer.activeInstruments.indexOf(instrument);
                
                if (index > -1) {
                    composer.activeInstruments.splice(index, 1);
                } else {
                    composer.activeInstruments.push(instrument);
                }
                
                showStatus(`${instrument} ${index > -1 ? 'removed' : 'added'}`, 'info');
            });
        });
        
        // MIDI file handling
        document.getElementById('midi-file').addEventListener('change', function(e) {
            const file = e.target.files[0];
            if (file) {
                document.getElementById('midi-preview').textContent = 
                    `Loaded: ${file.name} (${(file.size / 1024).toFixed(2)} KB)`;
                showStatus('MIDI file loaded - theme import ready', 'success');
            }
        });
        
        // Initialize
        document.getElementById('log').value = 'Quintet Composer v9.5 initialized\nReady to compose...';
    </script>
</body>
</html>